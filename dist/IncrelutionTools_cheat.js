/* 
 * https://github.com/lgl017temp/increlution-tools
 * 流程图汉化可使用gitxy的, 也可使用项目内修改过的版本，详见项目下说明
 * 将本文件放在electron-index.html旁，以下代码段放在最后html最后
 * <script src="IncrelutionTools_cheat.js" type="module" charset="utf-8"></script>
 */
let c={locale:"cn"},O={},N="cn",T=[];class Y extends HTMLElement{wrapper;constructor(){super();const e=this.attachShadow({mode:"open"}),t=document.createElement("link");t.href="helpers/bootstrap.min.css",t.rel="stylesheet",t.type="text/css",e.appendChild(t);const o=document.createElement("link");o.href="helpers/fontawesome-pro-5.13.0-web/css/all.min.css",o.rel="stylesheet",o.type="text/css",e.appendChild(o);const s=document.createElement("link");s.href="gsrv.css",s.rel="stylesheet",s.type="text/css",e.appendChild(s),this.wrapper=document.createElement("body"),window.document.body.classList.contains("dark")&&this.wrapper.classList.add("dark"),e.appendChild(this.wrapper),new MutationObserver(d=>{d.forEach(n=>{n.type!=="attributes"&&n.attributeName!=="class"||(window.document.body.classList.contains("dark")?this.wrapper.classList.add("dark"):this.wrapper.classList.remove("dark"))})}).observe(window.document.body,{attributes:!0})}getFormControlStyle(e="input"){let t=document.createElement(e);t.classList.add("form-control"),t.style.display="none",this.wrapper.appendChild(t);let o=t.computedStyleMap(),s={};return o.forEach((d,n)=>{s[n]=d.map(l=>l.toString())}),this.wrapper.removeChild(t),s}}let g,D,B;function z(){W();let a=document.createElement("style");a.innerHTML="#action-containers-column .row.game-block-container:last-child { margin-bottom: 30px; }",document.head.appendChild(a),customElements.define("tool-container",Y),D=$('<tool-container style="display: flex; align-items: flex-end;flex-wrap: wrap;flex-direction: row;justify-content: flex-end;position: absolute; bottom: 0; left: 0; max-width: 100vw;"></tool-container>'),g=$(D[0].wrapper),B=$(`<button style="margin-left: 40px;height:20px;padding:0 10px;font-size:12px;width: fit-content; display: inline-block; vertical-align: sub; margin-right: 10px;" type="button" class="btn btn-block btn-light""><span>${f(`lang[${c.locale}]`)}</span></button>`),g.append(B),B.on("click",function(e){let t=Object.keys(O),o=t.indexOf(c.locale);o===-1&&(o=0),o++,o%=t.length,c.locale=t[o],v(),H()}),T.forEach(e=>{e.settings&&Object.keys(e.settings).forEach(t=>{c[t]===void 0&&(c[t]=e.settings[t])}),e.init&&e.init()}),D.appendTo("body"),q()}function W(){if(localStorage&&localStorage.getItem("cheatSettings")){let a=JSON.parse(localStorage.getItem("cheatSettings"));Object.keys(a).forEach(e=>{c[e]=a[e]})}}function v(){localStorage&&localStorage.setItem("cheatSettings",JSON.stringify(c))}function q(){T.forEach(a=>{a.toggle&&a.toggle()})}function H(){B.find("span").html(f(`lang[${c.locale}]`)),T.forEach(a=>{a.changeLocale&&a.changeLocale()})}function f(a){let e=O[c.locale],t=a.split(/\.|\[/).map(n=>n.replace(/\]$/,"")),o=e,s=!1;if(t.every(n=>o instanceof Object?(o=o[n],!0):(console.error(`message not found: ${a}, in locale ${c.locale}`),s=!0,!1)),o===void 0&&(console.error(`message not found: ${a}, in locale ${c.locale}`),s=!0),!s)return o;let d=!1;return e=O[N],o=e,t.every(n=>o instanceof Object?(o=o[n],!0):(console.error(`message not found: ${a}, in locale ${N}`),d=!0,!1)),o===void 0&&(console.error(`message not found: ${a}, in locale ${N}`),d=!0),d?a:o}function M(a){return window.Function(`"use strict";return ${a};`)()}let U,V=new Promise(a=>{U=a}),Z=setInterval(function(){game&&(clearInterval(Z),z(),U(),se())},1e3),G,J=new Promise(a=>{G=a}),i=new class{skill={};job={};construction={};exploration={};hostile={};itemType={};food={};resource={};boss={};bossPhase={};bossAttr={};bossStory={};enemy={};perk={}},K=["","K","M","B","T","Qa"];function ee(a){typeof a!="number"&&(a=a.toNumber());let e=0;for(;a>=1e3;)e++,a=a/1e3;return+a.toFixed(2)+K[e]}let Q=[];function X(a){return a=+a,Q[a]}let te={"fa-wheat":"\uF72D","fa-axe":"\uF6B2","fa-hammer":"\uF6E3","fa-running":"\uF70C","fa-fish":"\uF578","fa-hat-chef":"\uF86B","fa-shovel":"\uF713","fa-swords":"\uF71D","fa-bow-arrow":"\uF6B9","fa-anchor":"\uF13D","fa-comments":"\uF086","fa-hourglass-half":"\uF252","fa-heart":"\uF004",health:"\uF004","fa-heart-broken":"\uF7A9",healthDec:"\uF7A9","fa-trailer":"\uF941",inventory:"\uF941","fa-angle-double-up":"\uF102",add:"\uF102","fa-angle-double-down":"\uF103",dec:"\uF103","fa-engine-warning":"\uF5F2",fail:"\uF5F2","fa-check":"\uF00C",ok:"\uF00C","fa-arrow-alt-square-up":"\uF353",full:"\uF353","fa-skull":"\uF54C","fa-shield":"\uF132","fa-archway":"\uF557"},h={},u={},I=[];function se(){$.ajax({url:"gniller-min.js",dataType:"text",success:a=>{window.gameData=i,window.vars=u,window.varNames=h,oe(a),ae(),ie();let e=0;do le();while(re()&&e<100);Object.keys(i.skill).forEach(t=>{let o=i.skill[t],s=o.dependency;s&&(o.dependency=S(s))}),Object.keys(i.job).forEach(t=>{let o=i.job[t],s=o.dependency;s&&(o.dependency=S(s))}),Object.keys(i.construction).forEach(t=>{let o=i.construction[t],s=o.dependency;s&&(o.dependency=S(s))}),Object.keys(i.exploration).forEach(t=>{let o=i.exploration[t],s=o.dependency;s&&(o.dependency=S(s))}),Object.keys(i.boss).forEach(t=>{let o=i.boss[t],s=o.dependency;s&&(o.dependency=S(s))}),Object.values(i.bossPhase).forEach(t=>{Object.keys(t).forEach(o=>{let s=t[o],d=s.dependency;d&&(s.dependency=S(d))})}),Object.keys(i.hostile).forEach(t=>{let o=i.hostile[t],s=o.dependency;s&&(o.dependency=S(s))}),G()}})}function w(a,e,t){let o=a.match(new RegExp(e,"g"));if(o&&o.length===1){let s=a.match(e);s&&s[1]&&(u[t]=s[1],h[s[1]]=t)}else throw console.log(o,e),new Error("not match or multi: "+t)}function oe(a){Object.keys(window).filter(s=>s.startsWith("a0_")).forEach(s=>{window[s]&&window[s][0]?window[s][0].shouldShow?window[s][0].name==="Farming"?h[s]="skill":window[s][0].name==="Gather berries"?h[s]="job":window[s][0].name==="Wooden cart"?h[s]="construction":window[s][0].name==="Explore the area"?h[s]="exploration":window[s][0].name==="Titan arrow"&&(h[s]="hostile"):window[s][0].name==="Food"?h[s]="itemType":window[s][0][0]&&window[s][0][0].name==="Berry"?h[s]="item":window[s][0].name==="Stone Titan"&&!window[s][0].phases?h[s]="enemy":window[s][0].name==="Stone Titan"&&window[s][0].phases?h[s]="boss":window[s][0][0]&&window[s][0][0].bossBarIcon?h[s]="bossAttr":window[s][0].name===""&&window[s][0].completedStory===""?h[s]="boss0Story":window[s][0].jobId!==void 0&&window[s][0].constructionId!==void 0&&window[s][0].explorationId!==void 0?h[s]="chep":typeof window[s][0]=="boolean"&&window[s].length===game.construction.length?h[s]="notFinishInThisTick":window[s][0].name==="Generation exp. req."&&(h[s]="perk"):window[s]&&typeof window[s]=="object"&&window[s].toNumber&&window[s].toNumber()===0?h[s]="0":window[s]&&typeof window[s]=="object"&&window[s].toNumber&&window[s].toNumber()===1?h[s]="1":window[s]&&typeof window[s]=="object"&&window[s].toNumber&&window[s].toNumber()===100&&(h[s]="100")}),Object.keys(h).forEach(s=>{u[h[s]]=s}),w(a,/^const (a0_0x[0-9a-f]+?)=\[/,"allString"),Q=M(u.allString).map(s=>window.atob(s)),w(a,new RegExp(`const (a0_0x[0-9a-f]+?)=function\\(_0x(?:[0-9a-f]+?),_0x(?:[0-9a-f]+?)\\){_0x(?:[0-9a-f]+?)=_0x(?:[0-9a-f]+?)-0x0;let _0x(?:[0-9a-f]+?)=${u.allString}\\[_0x(?:[0-9a-f]+?)\\];`),"getString"),w(a,new RegExp("function (a0_0x[0-9a-f]+?)\\(_0x(?:[0-9a-f]+?)=0x0\\){if\\(a0_0x(?:[0-9a-f]+?)==null\\)"),"getInventorySize"),w(a,new RegExp(`function (a0_0x[0-9a-f]+?)\\(_0x(?:[0-9a-f]+?),_0x(?:[0-9a-f]+?)\\){return game\\[(?:'inventory'|${u.getString}\\('0x(?:[0-9a-f]+?)'\\))\\]\\[_0x(?:[0-9a-f]+?)\\]\\[_0x(?:[0-9a-f]+?)\\]\\[(?:'amount'|${u.getString}\\('0x(?:[0-9a-f]+?)'\\))\\]\\[(?:'cmp'|${u.getString}\\('0x(?:[0-9a-f]+?)'\\))\\]\\(${u.getInventorySize}\\(\\)\\)>=0x0;}`),"isFullItem"),w(a,new RegExp(`function (a0_0x[0-9a-f]+?)\\(_0x(?:[0-9a-f]+?)\\){for\\(let _0x(?:[0-9a-f]+?) in _0x(?:[0-9a-f]+?)\\){if\\(!${u.isFullItem}`),"isFullAllItem");let e=Object.keys(h).filter(s=>h[s]==="1"),t=Object.keys(h).filter(s=>h[s]==="0");w(a,new RegExp(`function (a0_0x[0-9a-f]+?)\\(_0x(?:[0-9a-f]+?),_0x(?:[0-9a-f]+?)\\){return game\\[(?:'inventory'|${u.getString}\\('0x(?:[0-9a-f]+?)'\\))\\]\\[_0x(?:[0-9a-f]+?)\\]\\[_0x(?:[0-9a-f]+?)\\]\\[(?:'amount'|${u.getString}\\('0x(?:[0-9a-f]+?)'\\))\\]\\[${u.getString}\\('0x(?:[0-9a-f]+?)'\\)\\]\\((?:${e.join("|")})\\)>=0x0;}`),"haveItem"),w(a,new RegExp(`function (a0_0x[0-9a-f]+?)\\(_0x(?:[0-9a-f]+?)\\){for\\(resourceId in _0x(?:[0-9a-f]+?)\\){if\\(!${u.haveItem}`),"haveAllItem"),w(a,new RegExp(`function (a0_0x[0-9a-f]+?)\\(_0x(?:[0-9a-f]+?)\\){if\\(${u.job}\\[_0x(?:[0-9a-f]+?)\\]\\[(?:'completionDamage'|${u.getString}\\('0x(?:[0-9a-f]+?)'\\))\\]==null\\)return Number\\[${u.getString}\\('0x(?:[0-9a-f]+?)'\\)\\];`),"leftHealthOnComplete"),w(a,new RegExp(`function (a0_0x[0-9a-f]+?)\\(_0x(?:[0-9a-f]+?),_0x(?:[0-9a-f]+?),_0x(?:[0-9a-f]+?)\\){let _0x(?:[0-9a-f]+?)=(?:${t.join("|")});for\\(let _0x(?:[0-9a-f]+?) in game\\[(?:'inventory'|${u.getString}\\('0x(?:[0-9a-f]+?)'\\))\\]\\[0x0\\]\\){`),"calcFoodTrade"),w(a,new RegExp(`function (a0_0x[0-9a-f]+?)\\(_0x(?:[0-9a-f]+?)\\){for\\(let _0x(?:[0-9a-f]+?) in ${u.construction}\\[_0x(?:[0-9a-f]+?)\\]\\[${u.getString}\\('0x(?:[0-9a-f]+?)'\\)\\]\\){let _0x(?:[0-9a-f]+?)=${u.construction}\\[_0x(?:[0-9a-f]+?)\\]\\[${u.getString}\\('0x(?:[0-9a-f]+?)'\\)\\]\\[_0x(?:[0-9a-f]+?)\\];`),"notArriveProgressStep"),w(a,new RegExp(`function (a0_0x[0-9a-f]+?)\\(_0x(?:[0-9a-f]+?)\\){if\\(game\\[(?:'boss'|${u.getString}\\('0x(?:[0-9a-f]+?)'\\))\\]==null\\)return 0x0;`),"getBossVariable"),w(a,new RegExp("function (a0_0x[0-9a-f]+?)\\(_0x(?:[0-9a-f]+?),_0x(?:[0-9a-f]+?)=!!\\[\\],_0x(?:[0-9a-f]+?)=!\\[\\]\\){if\\(a0_0x(?:[0-9a-f]+?)\\(_0x(?:[0-9a-f]+?)\\)!=null\\)return"),"willNotDie");let o=M(u.chep);I=Object.values(o).map(s=>s.explorationId),Object.keys(u).forEach(s=>{let d=u[s];if(s==="skill"){let n=window[d];Object.keys(n).forEach(l=>{let r=n[l],p=m(r.shouldShow);i.skill[l]={...r,id:+l,shouldShow:p}})}else if(s==="job"){let n=window[d];Object.keys(n).forEach(l=>{let r=n[l],p=m(r.baseShouldShow),b=m(r.shouldShow),k=m(r.baseCanRun),P=m(r.canRun);i.job[l]={...r,baseShouldShow:p,shouldShow:b,baseCanRun:k,canRun:P,tooltip:r.getTooltip?r.getTooltip():r.tooltip}})}else if(s==="construction"){let n=window[d];Object.keys(n).forEach(l=>{let r=n[l],p=m(r.baseShouldShow),b=m(r.shouldShow),k=m(r.baseCanRun),P=m(r.canRun);i.construction[l]={...r,baseShouldShow:p,shouldShow:b,baseCanRun:k,canRun:P}})}else if(s==="exploration"){let n=window[d];Object.keys(n).forEach(l=>{let r=n[l],p=m(r.baseShouldShow),b=m(r.shouldShow),k=m(r.baseCanRun),P=m(r.canRun);i.exploration[l]={...r,baseShouldShow:p,shouldShow:b,baseCanRun:k,canRun:P}})}else if(s==="hostile"){let n=window[d];Object.keys(n).forEach(l=>{let r=n[l],p=m(r.baseShouldShow),b=m(r.shouldShow),k=m(r.canRun);i.hostile[l]={...r,baseShouldShow:p,shouldShow:b,canRun:k}})}else if(s==="itemType"){let n=window[d];Object.keys(n).forEach(l=>{let r=n[l];i.itemType[l]={...r,id:+l}})}else if(s==="item"){let n=window[d][0];Object.keys(n).forEach(r=>{let p=n[r];i.food[r]={...p,id:+r,description:p.getDescription?p.getDescription():p.description}});let l=window[d][1];Object.keys(l).forEach(r=>{let p=l[r];i.resource[r]={...p,id:+r}})}else if(s==="boss"){let n=window[d];Object.keys(n).forEach(l=>{let r=n[l];i.boss[l]={...r,id:+l},i.bossPhase[l]={},Object.keys(r.phases).forEach(p=>{i.bossPhase[l][p]={bossId:+l,id:+p,phase:+p,health:r.phases[p].health,storyId:r.phases[p].storyId,dependency:[]},p==="0"?i.bossPhase[l][p].dependency.push({id:l,type:"boss"}):i.bossPhase[l][p].dependency.push({id:l,type:"boss",phase:+p-1})})})}else if(s==="bossAttr"){let n=window[d];Object.keys(n).forEach(l=>{let r=n[l];i.bossAttr[l]={...r}})}else if(s==="boss0Story"){let n=window[d];Object.keys(n).forEach(l=>{let r=n[l];i.bossStory[0]||(i.bossStory[0]={}),i.bossStory[0][l]={...r}})}else if(s==="enemy"){let n=window[d];Object.keys(n).forEach(l=>{let r=n[l];i.enemy[l]={...r}})}else if(s==="perk"){let n=window[d];Object.keys(n).forEach(l=>{let r=n[l];i.perk[l]={...r}})}})}function m(a,e){let t=/function\(.*?\)\{(.*)\}/,o=(""+a).match(t);if(!o)throw console.log(""+a),new Error("func not match");return ne(o[1])}function ne(a,e){let t=a;return Object.keys(h).forEach(o=>{t=t.replace(new RegExp(o,"g"),h[o])}),t=t.replace(/getString\('(0x[0-9a-f]+)'\)/g,(o,s)=>"'"+X(s)+"'"),t=t.replace(/([\[\(, ])(0x[0-9a-f]+)([\]\), ])/g,(o,s,d,n)=>s+M(d)+n),t=t.replace(/(0x0)/g,"0"),t=t.replace(/!!\[\]/g," true"),t=t.replace(/!\[\]/g," false"),t=t.replace(/(job|construction|exploration)\[_0x[0-9a-f]+\]/g,(o,s)=>s+"[this['id']]"),t}function ae(){Object.keys(i.skill).forEach(a=>{let e=i.skill[a];Object.keys(e).forEach(t=>{["id","icon","name","shouldShow"].indexOf(t)===-1&&console.warn("new prop",t,"skill",e)})}),Object.keys(i.job).forEach(a=>{let e=i.job[a];Object.keys(e).forEach(t=>{["baseCanRun","baseShouldShow","canRun","icon","id","name","onComplete","requiredProgress","requiredResourceId","rewardedItems","shouldShow","skillId","tooltip","getTooltip","automationUnlockAlternative","completionDamage","automationRequirement","requiredResourceAmount","foodTrade","isExcludedFromPassiveJobs"].indexOf(t)===-1&&console.warn("new prop",t,"job",e)})}),Object.keys(i.construction).forEach(a=>{let e=i.construction[a];Object.keys(e).forEach(t=>{["baseCanRun","baseShouldShow","canRun","id","name","onComplete","requiredProgress","requiredResources","shouldShow","skillId","tooltip","inventorySize","decayMultiplier","automationUnlockAlternative","maxHealthGainMultiplier","automationRequirement","getTooltip"].indexOf(t)===-1&&console.warn("new prop",t,"construction",e)})}),Object.keys(i.exploration).forEach(a=>{let e=i.exploration[a];Object.keys(e).forEach(t=>{["baseCanRun","baseShouldShow","canRun","completedStory","getCompletedStory","id","name","onComplete","requiredProgress","shouldShow","skillId","tooltip","getTooltip","isStoryBranch","startsBranch","branchColor","additionalDamagePerMs","maxHealthGainMultiplier","automationUnlockAlternative","decayMultiplier","completionDamage","awardItem","multiplierRequirement","failDamage","completionScaling","automationRequirement","isRepeatable","skipCompletedStory","bossId","bossDamage","bossPhases","bossScalingVariable","bossScalingVariableIncrease"].indexOf(t)===-1&&console.warn("new prop",t,"exploration",e)})}),Object.keys(i.hostile).forEach(a=>{let e=i.hostile[a];Object.keys(e).forEach(t=>{["baseShouldShow","bossId","bossPhases","canRun","completionDamage","completionBossHealing","completionSpeedIncrease","enemy","id","name","onComplete","requiredProgress","shouldShow","tooltip"].indexOf(t)===-1&&console.warn("new prop",t,"hostile",e)})}),Object.keys(i.boss).forEach(a=>{let e=i.boss[a];Object.keys(e).forEach(t=>{["name","phases","id"].indexOf(t)===-1&&console.warn("new prop",t,"boss",e)})}),Object.keys(i.bossAttr).forEach(a=>{let e=i.bossAttr[a];Object.values(e).forEach(t=>{Object.keys(t).forEach(o=>{["bossBarIcon","description","scalingMultiplier","showOnBossBar"].indexOf(o)===-1&&console.warn("new prop",o,"bossAttr",e)})})})}function ie(){Object.keys(i.skill).forEach(a=>{let e=i.skill[a],t=[];t.push(...y(e.shouldShow,"skill",e)),e.dependency=t}),Object.keys(i.job).forEach(a=>{let e=i.job[a],t=[];t.push(...y(e.baseShouldShow,"job",e)),t.push(...y(e.baseCanRun,"job",e)),t.push(...y(e.shouldShow,"job",e)),t.push(...y(e.canRun,"job",e)),e.dependency=t}),Object.keys(i.construction).forEach(a=>{let e=i.construction[a],t=[];t.push(...y(e.baseShouldShow,"construction",e)),t.push(...y(e.baseCanRun,"construction",e)),t.push(...y(e.shouldShow,"construction",e)),t.push(...y(e.canRun,"construction",e)),e.dependency=t}),Object.keys(i.exploration).forEach(a=>{let e=i.exploration[a],t=[];t.push(...y(e.baseShouldShow,"exploration",e)),t.push(...y(e.baseCanRun,"exploration",e)),t.push(...y(e.shouldShow,"exploration",e)),t.push(...y(e.canRun,"exploration",e)),e.dependency=t}),Object.keys(i.hostile).forEach(a=>{let e=i.hostile[a],t=[];t.push(...y(e.baseShouldShow,"exploration",e)),t.push(...y(e.shouldShow,"exploration",e)),t.push(...y(e.canRun,"exploration",e)),e.dependency=t})}function y(a,e,t){a=a.replace(/;$/,"");let o=a.split(";").map(d=>d.split("&&(")).map(d=>d.map(n=>n.split(/\|\||&&/))),s=[];if(o.forEach(d=>{d.forEach(n=>{n.forEach(l=>{if(l=l.replace(/^return[ ]?/,"").replace(/;$/,"").replace(/^\(/,"").replace(/\)$/,""),l!=="typeof game!=='undefined'"&&l!=="true"&&!l.match(new RegExp("^game\\['skills'\\]\\["+t.id+"\\]\\['instinctLevel'\\]\\['cmp'\\]\\(1\\)>=0$"))&&l!=="job[this['id']]['baseShouldShow']("&&l!=="job[this['id']]['baseCanRun']("&&l!=="construction[this['id']]['baseShouldShow']("&&l!=="construction[this['id']]['baseCanRun']("&&l!=="exploration[this['id']]['baseShouldShow']("&&l!=="exploration[this['id']]['baseCanRun']("&&l!=="hostile[this['id']]['baseShouldShow']("&&l!=="game['construction'][this['id']]['currentProgress']['cmp'](0)>0"&&l!=="game['inventory'][1][this['requiredResourceId']]['amount']['cmp'](this['requiredResourceAmount'])>=0"){if(l==="game['boss']==null")if(s.length){let r=-1;s.forEach(p=>{let b=i[p.type][p.id];b.bossId!==void 0&&(r=b.bossId)}),r!==-1&&i.boss[r]?s.push({id:""+r,type:"boss",phase:Object.keys(i.bossPhase[r]).reduce((p,b)=>Math.max(p,+b),0)}):console.warn("not find bossId")}else console.warn("not find bossId");else if(l!=="game['boss']!=null"){if(l==="game['boss']['phase']>=0x4")if(s.length){let r=-1;s.forEach(p=>{let b=i[p.type][p.id];b.bossId!==void 0&&(r=b.bossId)}),r!==-1&&i.boss[r]?s.push({id:""+r,type:"boss",phase:4}):console.warn("not find bossId")}else console.warn("not find bossId");else if(l!=="this['isRepeatable']"&&l!=="job[this['id']]['requiredProgress']['sub'](game['jobs'][this['id']]['currentProgress'])['div'](game['skills'][job[this['id']]['skillId']]['currentMultiplier'])['cmp'](100)>0"&&!l.startsWith("leftHealthOnComplete")&&!l.startsWith("notFinishInThisTick")&&!l.startsWith("haveItem")&&!l.startsWith("haveAllItem")&&!l.startsWith("calcFoodTrade")&&!l.startsWith("notArriveProgressStep")&&!l.startsWith("!isFullAllItem")&&!l.startsWith("willNotDie")&&!l.startsWith("getBossVariable")&&!l.startsWith("!(getBossVariable")){if(l==="game['boss']['id']==hostile[this['id']]['bossId']"){let r=t.bossId;if(r!==void 0)s.push({type:"boss",id:""+r});else throw console.error(t),new Error("data no bossId")}else if(l==="hostile[this['id']]['bossPhases']['includes'](game['boss']['phase']"){let r=t.bossId,p=t.bossPhases;if(r!==void 0)if(p)p.forEach(b=>{s.push({type:"boss",id:""+r,phase:b})});else throw console.error(t),new Error("data no bossPhases");else throw console.error(t),new Error("data no bossId")}else if(l==="game['boss']['id']==exploration[this['id']]['bossId']"){let r=t.bossId;if(r!==void 0)s.push({type:"boss",id:""+r});else throw console.error(t),new Error("data no bossId")}else if(l==="exploration[this['id']]['bossPhases']['includes'](game['boss']['phase']"){let r=t.bossId,p=t.bossPhases;if(r!==void 0)if(p)p.forEach(b=>{s.push({type:"boss",id:""+r,phase:b})});else throw console.error(t),new Error("data no bossPhases");else throw console.error(t),new Error("data no bossId")}else if(!l.match(/let _0x(?:[0-9a-f]+?)=_0x(?:[0-9a-f]+?)!=null/)&&!l.match(/_0x(?:[0-9a-f]+?)\['forceFight'\]!=null\?_0x(?:[0-9a-f]+?)\['forceFight'\]: false/)&&!l.match(/^!game\['(\w+)'\]\[(\d+)\]\[('timesCompleted'|'isFinished')\]/)&&!l.match(/^!\(game\['(\w+)'\]\[(\d+)\]\[('timesCompleted'|'isFinished')\]/)&&!l.match(/^!game\['(\w+)'\]\[this\['id'\]\]\[('timesCompleted'|'isFinished')\]/)&&!l.match(/^!game\['(\w+)'\]\[this\['id'\](-|\+)0x(\d+)\]\[('timesCompleted'|'isFinished')\]/))if(l.match(/^game\['(\w+)'\]\[(\d+)\]\[('timesCompleted'|'isFinished')\]/)){let r=l.match(/^game\['(\w+)'\]\[(\d+)\]\[('timesCompleted'|'isFinished')\]/);if(i[r[1]]&&i[r[1]][r[2]])r[1]===e&&+r[2]>t.id||s.push({type:r[1],id:r[2]});else throw console.error(r),new Error("data not found")}else if(l.match(/^game\['(\w+)'\]\[this\['id'\](-|\+)0x(\d+)\]\[('timesCompleted'|'isFinished')\]/)){let r=l.match(/^game\['(\w+)'\]\[this\['id'\](-|\+)0x(\d+)\]\[('timesCompleted'|'isFinished')\]/),p=1;if(r[2]==="-"&&(p=-1),i[r[1]]&&i[r[1]][t.id+ +r[3]*p])r[1]===e&&t.id+ +r[3]*p>t.id||s.push({type:r[1],id:""+(t.id+ +r[3]*p)});else throw console.error(r),new Error("data not found")}else t.name==="Return to the kids"?t.requiredResources={0:{amount:new Decimal(-1),itemId:20}}:console.log(l,a,o,t)}}}})})}),t.name==="Approach statue")t.addBoss=0;else if(t.name==="Return to titan")i.bossPhase[0][2].dependency.push({id:""+t.id,type:"exploration"});else if(t.bossDamage){let d=t.bossId,n=t.bossPhases;if(d===void 0)throw console.error(t),new Error("data no bossId");if(n===void 0)throw console.error(t),new Error("data no bossPhases");n[0]===0&&i.bossPhase[d][1]&&i.bossPhase[d][1].dependency.push({id:""+t.id,type:"exploration"})}return s}function S(a){let e=[];return a.forEach(t=>{e.find(o=>o.type===t.type&&o.id===t.id&&o.phase===t.phase)||e.push(t)}),e.sort((t,o)=>{if(t.type==="boss"&&o.type==="boss"){let s=t.phase??-1,d=o.phase??-1;return s-d}return 0}),e}function le(){let a=0,e=!1;for(;!e&&a<100;){a++,e=!0;let t=!1;x(0)&&(t=!0);try{Object.keys(i.skill).forEach(o=>{let s=i.skill[o];if(s.level===void 0)throw new Error;x(s.level,{id:o,type:"skill"})&&(t=!0)})}catch{e=!1}try{Object.keys(i.job).forEach(o=>{let s=i.job[o];if(s.level===void 0)throw new Error;x(s.level,{id:o,type:"job"})&&(t=!0),s.rewardedItems&&Object.values(s.rewardedItems).filter(d=>d.itemType===1).forEach(d=>{x(s.level,{id:""+d.itemId,type:"resources"})&&(t=!0)})})}catch{e=!1}try{Object.keys(i.construction).forEach(o=>{let s=i.construction[o];if(s.level===void 0)throw new Error;x(s.level,{id:o,type:"construction"})&&(t=!0)})}catch{e=!1}try{Object.keys(i.exploration).forEach(o=>{let s=i.exploration[o];if(s.level===void 0)throw new Error;x(s.level,{id:o,type:"exploration"})&&(t=!0),s.awardItem&&s.awardItem.type===1&&x(s.level,{id:""+s.awardItem.id,type:"resources"})&&(t=!0)})}catch{e=!1}try{Object.keys(i.boss).forEach(o=>{let s=i.boss[o];if(s.level===void 0)throw new Error;x(s.level,{id:o,type:"boss"})&&(t=!0)})}catch{e=!1}try{Object.values(i.bossPhase).forEach(o=>{Object.keys(o).forEach(s=>{let d=o[s];if(d.level===void 0)throw new Error;x(d.level,{id:""+d.bossId,type:"boss",phase:d.phase})&&(t=!0)})})}catch{e=!1}try{Object.keys(i.hostile).forEach(o=>{let s=i.hostile[o];if(s.level===void 0)throw new Error;x(s.level,{id:o,type:"hostile"})&&(t=!0)})}catch{e=!1}t&&(e=!1)}}function x(a,e){let t=!1;if(Object.keys(i.skill).forEach(o=>{let s=i.skill[o],d=!1;e===void 0&&s.dependency?.length===0?d=!0:e!==void 0&&e.phase!==void 0&&s.dependency?.find(n=>n.id===e.id&&n.type===e.type&&n.phase===e.phase)?(e.type!=="boss"||e.type==="boss"&&s.dependency?.filter(n=>n.type==="boss"&&n.phase!==void 0).findIndex(n=>n.id===e.id&&n.type===e.type&&n.phase===e.phase)===0)&&(d=!0):e!==void 0&&e.phase===void 0&&s.dependency?.find(n=>n.id===e.id&&n.type===e.type)&&(d=!0),d&&(!s.level||s.level<a+1)&&(s.level=a+1,t=!0)}),Object.keys(i.job).forEach(o=>{let s=i.job[o],d=!1;e===void 0&&s.dependency?.length===0?d=!0:e!==void 0&&e.phase!==void 0&&s.dependency?.find(n=>n.id===e.id&&n.type===e.type&&n.phase===e.phase)?(e.type!=="boss"||e.type==="boss"&&s.dependency?.filter(n=>n.type==="boss"&&n.phase!==void 0).findIndex(n=>n.id===e.id&&n.type===e.type&&n.phase===e.phase)===0)&&(d=!0):e!==void 0&&e.phase===void 0&&s.dependency?.find(n=>n.id===e.id&&n.type===e.type)?(e.type!=="exploration"||e.type==="exploration"&&s.dependency?.filter(n=>n.type==="exploration").findIndex(n=>n.id===e.id&&n.type===e.type)===0)&&(d=!0):e!==void 0&&e.phase===void 0&&s.requiredResourceId&&e.type==="resources"&&+e.id===s.requiredResourceId&&(d=!0),d&&(!s.level||s.level<a+1)&&(s.level=a+1,t=!0)}),Object.keys(i.construction).forEach(o=>{let s=i.construction[o],d=!1;e===void 0&&s.dependency?.length===0?d=!0:e!==void 0&&e.phase!==void 0&&s.dependency?.find(n=>n.id===e.id&&n.type===e.type&&n.phase===e.phase)?(e.type!=="boss"||e.type==="boss"&&s.dependency?.filter(n=>n.type==="boss"&&n.phase!==void 0).findIndex(n=>n.id===e.id&&n.type===e.type&&n.phase===e.phase)===0)&&(d=!0):e!==void 0&&e.phase===void 0&&s.dependency?.find(n=>n.id===e.id&&n.type===e.type)&&(d=!0),d&&(!s.level||s.level<a+1)&&(s.level=a+1,t=!0)}),Object.keys(i.exploration).forEach(o=>{let s=i.exploration[o],d=!1;e===void 0&&s.dependency?.length===0?d=!0:e!==void 0&&e.phase!==void 0&&s.dependency?.find(n=>n.id===e.id&&n.type===e.type&&n.phase===e.phase)?(e.type!=="boss"||e.type==="boss"&&s.dependency?.filter(n=>n.type==="boss"&&n.phase!==void 0).findIndex(n=>n.id===e.id&&n.type===e.type&&n.phase===e.phase)===0)&&(d=!0):e!==void 0&&e.phase===void 0&&s.dependency?.find(n=>n.id===e.id&&n.type===e.type)&&(d=!0),d&&(!s.level||s.level<a+1)&&(s.level=a+1,t=!0)}),Object.values(i.bossPhase).forEach(o=>{Object.keys(o).forEach(s=>{let d=o[s],n=!1;e===void 0&&d.dependency?.length===0?n=!0:e!==void 0&&e.phase!==void 0&&d.dependency?.find(l=>l.id===e.id&&l.type===e.type&&l.phase===e.phase)?(e.type!=="boss"||e.type==="boss"&&d.dependency?.filter(l=>l.type==="boss"&&l.phase!==void 0).findIndex(l=>l.id===e.id&&l.type===e.type&&l.phase===e.phase)===0)&&(n=!0):e!==void 0&&e.phase===void 0&&d.dependency?.find(l=>l.id===e.id&&l.type===e.type)&&(n=!0),n&&(!d.level||d.level<a+1)&&(d.level=a+1,t=!0)})}),Object.keys(i.hostile).forEach(o=>{let s=i.hostile[o],d=!1;e===void 0&&s.dependency?.length===0?d=!0:e!==void 0&&e.phase!==void 0&&s.dependency?.find(n=>n.id===e.id&&n.type===e.type&&n.phase===e.phase)?(e.type!=="boss"||e.type==="boss"&&s.dependency?.filter(n=>n.type==="boss"&&n.phase!==void 0).findIndex(n=>n.id===e.id&&n.type===e.type&&n.phase===e.phase)===0)&&(d=!0):e!==void 0&&e.phase===void 0&&s.dependency?.find(n=>n.id===e.id&&n.type===e.type)&&(d=!0),d&&(!s.level||s.level<a+1)&&(s.level=a+1,t=!0)}),e?.type==="exploration"&&i.exploration[e.id].addBoss!==void 0){let o=i.exploration[e.id].addBoss,s=i.boss[o];s.dependency||(s.dependency=[]),s.dependency.push({id:e.id,type:"exploration"}),(!s.level||s.level<a+1)&&(s.level=a+1,t=!0),Object.values(i.bossPhase[o]).forEach((d,n)=>{let l=d;(!l.level||l.level<a+1)&&(l.level=a+1,t=!0)})}return t}function re(){Object.keys(i.skill).forEach(t=>{let o=i.skill[t];if(o.level===void 0)throw console.log(o),new Error("data no level")}),Object.keys(i.job).forEach(t=>{let o=i.job[t];if(o.level===void 0)throw console.log(o),new Error("data no level")}),Object.keys(i.construction).forEach(t=>{let o=i.construction[t];if(o.level===void 0)throw console.log(o),new Error("data no level")}),Object.keys(i.exploration).forEach(t=>{let o=i.exploration[t];if(o.level===void 0)throw console.log(o),new Error("data no level")}),Object.keys(i.boss).forEach(t=>{let o=i.boss[t];if(o.level===void 0)throw console.log(o),new Error("data no level")}),Object.values(i.bossPhase).forEach(t=>{Object.keys(t).forEach(o=>{let s=t[o];if(s.level===void 0)throw console.log(s),new Error("data no level")})}),Object.keys(i.hostile).forEach(t=>{let o=i.hostile[t];if(o.level===void 0)throw console.log(o),new Error("data no level")});let a=!1,e=I.map((t,o)=>({chep:o+1,start:i.exploration[t].level,end:I[o+1]?i.exploration[I[o+1]-1].level:void 0}));return e.forEach((t,o)=>{e[o-1]&&t.start<=e[o-1].end&&(i.exploration[I[o]].level=e[o-1].end+1,a=!0)}),a}let j,C,F,_,R,E,A,L;T.push({init:()=>{L=$(`<button style="height:20px;padding:0 10px;font-size:12px;width: fit-content; display: inline-block; vertical-align: sub; margin-right: 10px;" id="pause-button" type="button" class="btn btn-block btn-success ${c.showCheat?"running":"paused"}"><i class="fas ${c.showCheat?"fa-play":"fa-pause"}"></i> <span>${f("cheat.toggleCheat")}</span></button>`),g.append(L),L.on("click",function(){c.showCheat?(c.showCheat=!1,$(this).addClass("paused").removeClass("running"),$(this).find("i").addClass("fa-pause").removeClass("fa-play")):(c.showCheat=!0,$(this).removeClass("paused").addClass("running"),$(this).find("i").removeClass("fa-pause").addClass("fa-play")),v(),q()}),j=$(`<button style="height:20px;padding:0 10px;font-size:12px;width: fit-content; display: inline-block; vertical-align: sub; margin-right: 10px;" id="pause-button" type="button" class="btn btn-block btn-success ${c.speedEn?"running":"paused"}"><i class="fas ${c.speedEn?"fa-play":"fa-pause"}"></i> <span><input style="display: inline-block;width: 52px;text-align:center;height: 12px;font-size:12px;" type="text" class="form-control" maxlength="3"> <span>${f("cheat.speed")}</span></span></button>`),g.append(j),j.find("input").val(c.speedMul).on("input",function(){let t=+$(this).val();if(isNaN(t)||t===1/0||t===-1/0||t%1!==0||t<=0){$(this).val(c.speedMul);return}c.speedMul=t,v()}),j.on("click",function(t){t.target instanceof HTMLInputElement||(c.speedEn?(c.speedEn=!1,$(this).addClass("paused").removeClass("running"),$(this).find("i").addClass("fa-pause").removeClass("fa-play")):(c.speedEn=!0,$(this).removeClass("paused").addClass("running"),$(this).find("i").removeClass("fa-pause").addClass("fa-play")),v())}),C=$(`<button style="height:20px;padding:0 10px;font-size:12px;width: fit-content; display: inline-block; vertical-align: sub; margin-right: 10px;" id="pause-button" type="button" class="btn btn-block btn-success ${c.skillEn?"running":"paused"}"><i class="fas ${c.skillEn?"fa-play":"fa-pause"}"></i> <span><input style="display: inline-block;width: 52px;text-align:center;height: 12px;font-size:12px;" type="text" class="form-control" maxlength="3"> <span>${f("cheat.skill")}</span></span></button>`),g.append(C),C.find("input").val(c.skillMul).on("input",function(){let t=+$(this).val();if(isNaN(t)||t===1/0||t===-1/0||t%1!==0||t<=0){$(this).val(c.skillMul);return}c.skillMul=t,v()}),C.on("click",function(t){t.target instanceof HTMLInputElement||(c.skillEn?(c.skillEn=!1,$(this).addClass("paused").removeClass("running"),$(this).find("i").addClass("fa-pause").removeClass("fa-play")):(c.skillEn=!0,$(this).removeClass("paused").addClass("running"),$(this).find("i").removeClass("fa-pause").addClass("fa-play")),v())}),F=$(`<button style="height:20px;padding:0 10px;font-size:12px;width: fit-content; display: inline-block; vertical-align: sub; margin-right: 10px;" id="pause-button" type="button" class="btn btn-block btn-success ${c.healthEn?"running":"paused"}"><i class="fas ${c.healthEn?"fa-play":"fa-pause"}"></i> <span>${f("cheat.health")}</span></button>`),g.append(F),F.on("click",function(){c.healthEn?(c.healthEn=!1,$(this).addClass("paused").removeClass("running"),$(this).find("i").addClass("fa-pause").removeClass("fa-play")):(c.healthEn=!0,$(this).removeClass("paused").addClass("running"),$(this).find("i").removeClass("fa-pause").addClass("fa-play")),v()}),_=$(`<button style="height:20px;padding:0 10px;font-size:12px;width: fit-content; display: inline-block; vertical-align: sub; margin-right: 10px;" id="pause-button" type="button" class="btn btn-block btn-success ${c.inventoryEn?"running":"paused"}"><i class="fas ${c.inventoryEn?"fa-play":"fa-pause"}"></i> <span>${f("cheat.storge")}</span></button>`),g.append(_),_.on("click",function(){c.inventoryEn?(c.inventoryEn=!1,$(this).addClass("paused").removeClass("running"),$(this).find("i").addClass("fa-pause").removeClass("fa-play")):(c.inventoryEn=!0,$(this).removeClass("paused").addClass("running"),$(this).find("i").removeClass("fa-pause").addClass("fa-play")),v()}),A=$(`<button style="height:20px;padding:0 10px;font-size:12px;width: fit-content; display: inline-block; vertical-align: sub; margin-right: 10px;" id="pause-button" type="button" class="btn btn-block btn-success ${c.perkEn?"running":"paused"}"><i class="fas ${c.perkEn?"fa-play":"fa-pause"}"></i> <span>${f("cheat.perk")}</span></button>`),g.append(A),A.on("click",function(){c.perkEn?(c.perkEn=!1,$(this).addClass("paused").removeClass("running"),$(this).find("i").addClass("fa-pause").removeClass("fa-play")):(c.perkEn=!0,$(this).removeClass("paused").addClass("running"),$(this).find("i").removeClass("fa-pause").addClass("fa-play")),v()}),R=$(`<button style="height:20px;padding:0 10px;font-size:12px;width: fit-content; display: inline-block; vertical-align: sub; margin-right: 10px;" id="pause-button" type="button" class="btn btn-block btn-success ${c.rebirthEn?"running":"paused"}"><i class="fas ${c.rebirthEn?"fa-play":"fa-pause"}"></i> <span>${f("cheat.rebirth")}</span></button>`),g.append(R),R.on("click",function(){c.rebirthEn?(c.rebirthEn=!1,$(this).addClass("paused").removeClass("running"),$(this).find("i").addClass("fa-pause").removeClass("fa-play")):(c.rebirthEn=!0,$(this).removeClass("paused").addClass("running"),$(this).find("i").removeClass("fa-pause").addClass("fa-play")),v()});let a=3,e=0;E=$(`<button style="height:20px;padding:0 10px;font-size:12px;width: fit-content; display: inline-block; vertical-align: sub; margin-right: 10px;" type="button" class="btn btn-block btn-light" data-original-title="${f("cheat.autoTip")}"><span>${f("cheat.auto")}</span></button>`),g.append(E),E.on("mousedown",function(){$(this).find("span").html("&emsp;&emsp;"+a+"&emsp;&emsp;"),e=window.setInterval(()=>{a!=0?(a--,$(this).find("span").html("&emsp;&emsp;"+a+"&emsp;&emsp;")):game&&(clearInterval(e),a=3,$(this).find("span").html(f("cheat.auto")),game.jobs.forEach(t=>{t.isAutomationUnlocked||(t.isAutomationUnlocked=!0,t.shouldAutomate===null&&(t.shouldAutomate=0))}),game.construction.forEach(t=>{t.isAutomationUnlocked||(t.isAutomationUnlocked=!0,t.shouldAutomate===null&&(t.shouldAutomate=0))}),game.exploration.forEach(t=>{t.isAutomationUnlocked||(t.isAutomationUnlocked=!0,t.shouldAutomate===null&&(t.shouldAutomate=0))}),setTimeout(()=>{$("#option-export-save-button").click(),setTimeout(()=>{navigator.clipboard.readText().then(t=>{$("#import-save-textarea").val(t),$("#import-save-textarea").trigger("change"),$("#import-save-confirm-button").click()})},200)},1e3))},1e3)}),$(document).on("mouseup",function(){clearInterval(e),a=3,E.find("span").html(f("cheat.auto"))})},settings:{speedMul:10,speedEn:!1,skillMul:10,skillEn:!1,inventoryEn:!1,healthEn:!1,rebirthEn:!1,perkEn:!1,showCheat:!1},toggle:()=>{c.showCheat?(j.show(),C.show(),F.show(),_.show(),A.show(),R.show(),E.show()):(j.hide(),C.hide(),F.hide(),_.hide(),A.hide(),R.hide(),E.hide())},changeLocale:()=>{j.find("span").find("span").html(f("cheat.speed")),C.find("span").find("span").html(f("cheat.skill")),F.find("span").html(f("cheat.health")),_.find("span").html(f("cheat.storge")),A.find("span").html(f("cheat.perk")),R.find("span").html(f("cheat.rebirth")),E.find("span").html(f("cheat.auto")),E.attr("data-original-title",f("cheat.autoTip")),L.find("span").html(f("cheat.toggleCheat"))}}),V.then(()=>{if(setInterval(function(){try{game&&c.speedEn&&(game.lastTimeStamp-=20*(c.speedMul-1))}catch{}},20),setInterval(function(){try{c.rebirthEn&&$("#reincarnate-button:visible").click()}catch{}},200),game){let a=game.inventory[0][0].amount.__proto__.add;game.inventory[0][0].amount.__proto__.add=function(e){return c.inventoryEn&&game.inventory.find(t=>t.find(o=>o.amount===this))&&e.lessThan(0)&&(e=new Decimal(0)),c.skillEn&&game.skills.find(t=>t.generationExperience===this||t.instinctExperience===this)&&e.greaterThan(0)&&(e=e.mul(c.skillMul)),c.healthEn&&game.health===this&&e.lessThan(0)&&(e=new Decimal(0)),a.bind(this)(e)}}}),J.then(()=>{Object.keys(i.perk).forEach(a=>{let e=i.perk[a].priceScale.pow;i.perk[a].priceScale.pow=function(t){return c.perkEn?new Decimal(0):e.bind(this)(t)}})}),O.cn={lang:{cn:"\u4E2D\u6587",en:"english"},cheat:{toggleCheat:"\u663E\u793A\u4FEE\u6539",speed:"\u500D\u901F",skill:"\u500D\u7ECF\u9A8C",health:"\u9501\u8840",storge:"\u9501\u5E93\u5B58",perk:"\u7279\u6743\u514D\u8D39",rebirth:"\u81EA\u52A8\u8F6C\u751F",auto:"\u89E3\u9501\u81EA\u52A8",autoTip:"\u8BF7\u5148\u5907\u4EFD\u5B58\u6863\uFF0C\u6B64\u64CD\u4F5C\u65E0\u64A4\u9500\uFF01<br/>(\u4F7F\u7528\u5B58\u8BFB\u6863\u65B9\u5F0F)<br/>(\u6309\u4F4F3\u79D2)"},chart:{togglePath:"\u663E\u793A\u8DEF\u7EBF",chepPrefix:"\u7B2C",chepSuffix:"\u7AE0",end:"\u7ED3\u675F",spoiler:"\u5141\u8BB8\u5267\u900F",highLightNotAuto:"\u9AD8\u4EAE\u81EA\u52A8\u672A\u89E3\u9501",jumpTo:"\u8DF3\u8F6C\u5230"}},O.en={lang:{cn:"\u4E2D\u6587",en:"English"},cheat:{toggleCheat:"Show Cheat",speed:"Times Speed",skill:"Times Exp",health:"Lock Health",storge:"Lock Storge",perk:"Perk Free",rebirth:"Auto Rebirth",auto:"Unlock All Auto",autoTip:"Please backup save first, can't undo!<br/>(use save and load implement)<br/>(press 3 sec)"},chart:{togglePath:"Show Path",chepPrefix:"Chep. ",chepSuffix:"",end:"End",spoiler:"Allow Spoiler",highLightNotAuto:"HighLight Automation Locked",jumpTo:"Jump To"}};export{g as btnContainer,H as changeLocale,I as cheps,M as doEval,ee as formatNum,i as gameData,V as gameLoadPromise,f as getLocal,X as getString,te as icons,z as init,W as load,O as locales,K as numUnits,T as plugins,J as readDataPromise,D as rootEl,v as save,c as settings,q as toggle,h as varNames,u as vars};
